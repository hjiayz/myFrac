var myFrac={OmyFrac:function(a,b,c){if(9007199254740991<a)throw"numerator too big!";if(9007199254740991<b)throw"denominator too big!";!0!=c?(c=myFrac.GCD(a,b),this.num=a/c,this.deno=b/c):(this.num=a,this.deno=b);0>this.deno&&(this.deno=-this.deno,this.num=-this.num)}};myFrac.OmyFrac.prototype.getNum=function(){return this.num};myFrac.OmyFrac.prototype.getDeno=function(){return this.deno};myFrac.OmyFrac.prototype.isProper=function(){return this.num<this.deno};
myFrac.OmyFrac.prototype.isInteger=function(){return 1==this.deno};myFrac.OmyFrac.prototype.getInteger=function(){return parseInt(this.num/this.deno)};myFrac.OmyFrac.prototype.getProper=function(){return myFrac.C(this.num%this.deno,this.deno)};myFrac.OmyFrac.prototype.toFloat=function(){return this.num/this.deno};myFrac.OmyFrac.prototype.toString=function(){return this.isInteger()?this.num.toString():this.num+"/"+this.deno};
myFrac.OmyFrac.prototype.toTeX=function(){var a=this.num,b="";0>a&&(a=-a,b="-");return this.isInteger()?"{"+this.num.toString()+"}":b+"{{"+a.toString()+"}\\over{"+this.deno.toString()+"}}"};myFrac.OmyFrac.prototype.toMathMl=function(){var a=this.num,b="";0>a&&(a=-a,b="<mo>-</mo>");return this.isInteger()?"<mn>"+this.num.toString()+"</mn>":b+"<mfrac><mn>"+a.toString()+"</mn><mn>"+this.deno.toString()+"</mn></mfrac>"};
myFrac.OmyFrac.prototype.O=function(a){switch(a){case "Num":return this.Num();case "Deno":return this.Deno();case "Integer":return this.getInteger();case "Proper":return this.getProper();case "Float":return this.toFloat();case "String":return this.toString();case "TeX":return this.toTeX();case "MathMl":return this.toMathMl()}throw"unknow type";};myFrac.C=function(a,b){return new myFrac.OmyFrac(a,b)};
myFrac.GCDbignum=function(a,b){var c=function(a){a=a.toString(2);return"0"==a.charAt(a.length-1)};0>a&&(a=-a);0>b&&(b=-b);if(1==a||1==b)return 1;for(var e=0;c(a)&&c(b);)a/=2,b/=2,e+=1;var d=function(a,b){if(0==a)return b;if(0==b)return a;for(;c(a);)a/=2;if(a<b)return arguments.callee((b-a)/2,a);a=(a-b)/2;return arguments.callee(a,b)};return c(a)?d(a/2,b)*Math.pow(2,e):d(b,a)*Math.pow(2,e)};
myFrac.GCD=function(a,b){if(2147483648<a||2147483648<b)return myFrac.GCDbignum(a,b);0>a&&(a=-a);0>b&&(b=-b);if(1==a||1==b)return 1;for(var c=0;0==(a&1)&&0==(b&1);)a>>=1,b>>=1,c+=1;var e=function(a,b){if(0==a)return b;if(0==b)return a;for(;0==(a&1);)a>>=1;if(a<b)return arguments.callee(b-a>>1,a);a=a-b>>1;return arguments.callee(a,b)};return 0==(a&1)?e(a>>1,b)<<c:e(b,a)<<c};myFrac.add=function(a,b){var c=myFrac.GCD(a.deno,b.deno);return myFrac.C(b.deno/c*a.num+a.deno/c*b.num,a.deno/c*b.deno)};
myFrac.sub=function(a,b){var c=myFrac.GCD(a.deno,b.deno);return myFrac.C(b.deno/c*a.num-a.deno/c*b.num,a.deno/c*b.deno)};myFrac.mul=function(a,b){var c=myFrac.GCD(a.num,b.deno),e=myFrac.GCD(b.num,a.deno);return myFrac.C(a.num/c*(b.num/e),a.deno/e*(b.deno/c),!0)};myFrac.div=function(a,b){var c=myFrac.GCD(a.num,b.num),e=myFrac.GCD(b.deno,a.deno),d=a.deno/e*(b.num/c);if(0==d)throw"DIV ZERO!";return myFrac.C(a.num/c*(b.deno/e),d,!0)};
myFrac.CBE=function(a){for(var b=0,c,e,d="",f="?",g=function(a,b,c){if("string"==typeof b){if(-1<b.indexOf(".")||isNaN(b))throw b+"is Not Integer!";b=myFrac.C(b,1)}switch(c){case "+":return myFrac.add(a,b);case "-":return myFrac.sub(a,b);case "*":return myFrac.mul(a,b);case "/":return myFrac.div(a,b);case "?":return b}return"err"};b<a.length;)if(0==a.charAt(b).search(/[\+\-\*\/]/))e=g(e,d,f),d="",f=a.charAt(b),b++;else if("("==a.charAt(b)){d=1;for(c=b;0<d;)c++,"("==a.charAt(c)&&d++,")"==a.charAt(c)&&
d--;d=arguments.callee(a.substring(b+1,c));b=c+1}else d+=a.charAt(b),b++;return e=g(e,d,f)};
myFrac.CBEsafe=function(a,b){a=a.replace(/([0-9]*)\.([0-9]*)/g,function(a,b,d){a=d.replace(/[0]+$/,"");return"("+b.replace(/^[0]+/,"")+a+"/1"+a.replace(/[0-9]/g,"0")+")"});if(-1<a.search(/[^0-9\+\-\*\/\(\)]/))throw"forbidden character!";a=a.replace(/(\()(\-[0-9]+)(\))/g,"(0$2)");if(-1<a.search(/(^[\+\-\*\/\)]{1,1})|([0-9]+[\(\)]+[0-9]+)|(\(\))|([\(]{1,1}[\+\-\*\/]{1,1})|([\+\-\*\/]{1,1}[\)]{1,1})|([\+\-\*\/]{1,1}[\+\-\*\/]{1,1})|([\+\-\*\/\(]{1,1}$)/))throw"improper expression!";return!1!==b?myFrac.CBE(function(a){var b=
function(b){")"==b&&(mod=-1);"("==b&&(mod=1);myp2=d+mod;if(a.charAt(myp2)==b)for(b=1;0<b;)myp2+=mod,")"==a.charAt(myp2)&&(b-=mod),"("==a.charAt(myp2)&&(b+=mod);else for(;!isNaN(a.charAt(myp2+mod))&&""!=a.charAt(myp2+mod);)myp2+=mod;return myp2},d=a.search(/[\*\/](?![\\])/);if(-1==d)return a;var f=b(")"),b=b("(");return("("==a.charAt(f-1)&&")"==a.charAt(b+1)?arguments.callee(a.substring(0,d+1)+"\\"+a.substring(d+1)):arguments.callee(a.substring(0,f)+"("+a.substring(f,d+1)+"\\"+a.substring(d+1,b+1)+
")"+a.substring(b+1))).replace(/[\\]/,"")}(a)):myFrac.CBE(a)};myFrac.parse=myFrac.CBEsafe;myFrac.eval=myFrac.CBEsafe;try{exports.load=myFrac}catch(e$$12){};
